<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§ŒëŠ¥ ìë™ê²¬ì  ê³„ì‚°ê¸° (ë²”ìš© í…œí”Œë¦¿)</title>
    <link rel="stylesheet" as="style" crossorigin="anonymous" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <style>
        :root {
            --primary-color: #2c3e50; /* ë²”ìš©ì ì¸ ë„¤ì´ë¹„ ì»¬ëŸ¬ */
            --bg-color: #f8f9fa;
            --container-bg: #ffffff;
            --text-main: #333333;
            --border-color: #dee2e6;
            --price-color: #e74c3c;
        }
        body {
            font-family: "Pretendard", sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0; padding: 40px 20px;
            display: flex; justify-content: center; min-height: 100vh;
        }
        .container {
            width: 100%; max-width: 600px; /* ì¡°ê¸ˆ ë” ì»´íŒ©íŠ¸í•˜ê²Œ */
            background: var(--container-bg);
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            overflow: hidden;
            display: flex; flex-direction: column;
        }
        
        /* Header */
        header {
            background: var(--primary-color); padding: 30px; color: white; text-align: center;
        }
        header h1 { margin: 0; font-size: 22px; font-weight: 800; }
        header p { margin: 8px 0 0; opacity: 0.8; font-size: 14px; }

        /* Tabs */
        .tab-nav { display: flex; border-bottom: 1px solid var(--border-color); }
        .tab-btn {
            flex: 1; padding: 15px; border: none; background: #fff;
            font-size: 16px; font-weight: 600; color: #888;
            cursor: pointer; transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }
        .tab-btn.active { color: var(--primary-color); border-bottom-color: var(--primary-color); background: #f8f9fa; }

        /* Content */
        .tab-content { display: none; padding: 40px 30px; animation: fadeIn 0.5s; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* Forms */
        .form-group { margin-bottom: 30px; }
        .form-label { display: block; font-weight: 700; margin-bottom: 8px; font-size: 15px; color: #555; }
        .form-input, .form-select, .form-textarea {
            width: 100%; padding: 12px; border: 1px solid var(--border-color);
            border-radius: 8px; font-size: 15px; box-sizing: border-box;
        }
        
        /* Quote Box */
        .quote-box {
            background: #f1f3f5; border-radius: 12px; padding: 30px; margin-top: 40px;
        }
        .quote-row { display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 15px; }
        .quote-total {
            border-top: 2px solid #ccc; padding-top: 15px; margin-top: 15px;
            display: flex; justify-content: space-between; align-items: center;
        }
        .total-price { font-size: 24px; font-weight: 800; color: var(--price-color); }

        /* Checkbox */
        .checkbox-group { display: flex; flex-direction: column; gap: 10px; }
        .checkbox-card {
            display: flex; align-items: center; padding: 12px;
            border: 1px solid var(--border-color); border-radius: 8px; cursor: pointer;
            transition: background 0.2s;
        }
        .checkbox-card:hover { background: #f8f9fa; }
        .checkbox-card input { margin-right: 12px; transform: scale(1.2); }

        /* Buttons */
        .btn-next, .btn-submit {
            width: 100%; padding: 15px; border: none; border-radius: 8px;
            font-weight: 700; cursor: pointer; font-size: 16px; margin-top: 20px;
        }
        .btn-next { background: #333; color: white; }
        .btn-submit { background: var(--primary-color); color: white; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }

        /* Modal */
        .modal-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.6); z-index: 9999; display: none;
        }
        .modal-overlay.visible { display: block; }
        .modal-box {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: white; padding: 30px; border-radius: 16px; width: 90%; max-width: 360px; text-align: center;
        }
        .modal-btn {
            background: #e1e4e8; color: #333; border: none; padding: 12px; width: 100%;
            border-radius: 8px; font-weight: 700; cursor: pointer; margin-top: 15px;
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1 id="uiTitle">ğŸ§® ìë™ ê²¬ì  ê³„ì‚°ê¸°</h1>
        <p id="uiDesc">ì›í•˜ì‹œëŠ” ì˜µì…˜ì„ ì„ íƒí•˜ë©´ ì˜ˆìƒ ê²¬ì ì„ ì¦‰ì‹œ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    </header>

    <form name="universal_quote" method="POST" data-netlify="true">
    <input type="hidden" name="form-name" value="universal_quote" />
    <input type="hidden" name="total_estimate" id="hiddenTotal" />

    <div class="tab-nav">
        <button type="button" class="tab-btn active" onclick="openTab('tab1')">1. ì˜ë¢° ì •ë³´</button>
        <button type="button" class="tab-btn" onclick="openTab('tab2')">2. ê²¬ì  í™•ì¸</button>
    </div>

    <!-- TAB 1: ì˜ë¢° ì •ë³´ -->
    <div id="tab1" class="tab-content active">
        <div class="form-group">
            <label class="form-label" id="lblProject">Q. í”„ë¡œì íŠ¸ëª… (ë˜ëŠ” ì œëª©)</label>
            <input type="text" id="projectTitle" name="project_title" class="form-input" placeholder="ì˜ˆ: í™ê¸¸ë™ í¬íŠ¸í´ë¦¬ì˜¤ ë””ìì¸">
        </div>
        <div class="form-group">
            <label class="form-label" id="lblCategory">Q. ì˜ë¢° ë¶„ì•¼ / ì—…ì¢…</label>
            <select id="category" name="category" class="form-select">
                <option value="" selected disabled hidden>ì„ íƒí•´ì£¼ì„¸ìš”</option>
                <!-- ì—‘ì…€ì—ì„œ ê°€ì ¸ì˜¨ ì˜µì…˜ë“¤ì´ ì—¬ê¸°ì— ìë™ìœ¼ë¡œ ì±„ì›Œì§‘ë‹ˆë‹¤ -->
            </select>
        </div>
        <div class="form-group">
            <label class="form-label" id="lblLevel">Q. ì‘ì—… ìœ í˜• (ë‚œì´ë„)</label>
            <select id="serviceLevel" name="service_level" class="form-select" onchange="calculateTotal()">
                <option value="" selected disabled hidden>ì„ íƒí•´ì£¼ì„¸ìš”</option>
                <option value="STANDARD" id="optLevel1">STANDARD (ê¸°ë³¸í˜•)</option>
                <option value="DELUXE" id="optLevel2">DELUXE (ê³ ê¸‰í˜•)</option>
                <option value="PREMIUM" id="optLevel3">PREMIUM (í”„ë¦¬ë¯¸ì—„)</option>
            </select>
            <p style="font-size:13px; color:#666; margin-top:8px;">* ë“±ê¸‰ë³„ ìƒì„¸ ë‚´ìš©ì€ ì„œë¹„ìŠ¤ ì„¤ëª… ì´ë¯¸ì§€ë¥¼ ì°¸ê³ í•´ì£¼ì„¸ìš”.</p>
        </div>
        
        <button type="button" class="btn-next" onclick="openTab('tab2')">ë‹¤ìŒ: ìˆ˜ëŸ‰ ë° ì˜µì…˜ ì„ íƒ ğŸ‘‰</button>
    </div>

    <!-- TAB 2: ê²¬ì  í™•ì¸ -->
    <div id="tab2" class="tab-content">
        <div class="form-group">
            <label class="form-label" id="lblQty">Q. ì‘ì—… ìˆ˜ëŸ‰ (ë‹¨ìœ„: ê°œ, ë¶„, í˜ì´ì§€ ë“±)</label>
            <input type="number" id="quantity" name="quantity" class="form-input" value="1" min="1" oninput="calculateTotal()">
            <span style="font-size:13px; color:#888; display:block; margin-top:4px;">* ê¸°ë³¸ ì œê³µ ìˆ˜ëŸ‰ ì´ˆê³¼ ì‹œ ì¶”ê°€ê¸ˆì´ ë°œìƒí•©ë‹ˆë‹¤.</span>
        </div>

        <div class="form-group">
            <label class="form-label" id="lblOpts">Q. ì¶”ê°€ ì˜µì…˜ ì„ íƒ</label>
            <div class="checkbox-group">
                <label class="checkbox-card">
                    <input type="checkbox" id="opt1" name="option_1" value="Yes" onchange="calculateTotal()">
                    <span id="labelOpt1">âš¡ ê¸‰í–‰ ì‘ì—… (ë¹ ë¥¸ ë§ˆê°)</span>
                </label>
                <label class="checkbox-card">
                    <input type="checkbox" id="opt2" name="option_2" value="Yes" onchange="calculateTotal()">
                    <span id="labelOpt2">ğŸ¨ ì›ë³¸ íŒŒì¼ ì œê³µ</span>
                </label>
                <label class="checkbox-card">
                    <input type="checkbox" id="opt3" name="option_3" value="Yes" onchange="calculateTotal()">
                    <span id="labelOpt3">ğŸ”„ ìˆ˜ì • íšŸìˆ˜ ì¶”ê°€</span>
                </label>
            </div>
        </div>

        <div class="quote-box">
            <div class="quote-row">
                <span>ê¸°ë³¸ ì‘ì—…ë¹„</span>
                <span id="basePriceDisplay">0ì›</span>
            </div>
            <div class="quote-row">
                <span>ì¶”ê°€ ìˆ˜ëŸ‰ ë¹„ìš©</span>
                <span id="quantityPriceDisplay">0ì›</span>
            </div>
            <div class="quote-row">
                <span>ì¶”ê°€ ì˜µì…˜ í•©ê³„</span>
                <span id="optionPriceDisplay">0ì›</span>
            </div>
            <div class="quote-total">
                <span>ì´ ì˜ˆìƒ ê²¬ì </span>
                <span class="total-price" id="totalPrice">0ì›</span>
            </div>
            <p style="font-size:13px; color:#666; margin-top:10px; text-align:right;">* ë¶€ê°€ì„¸(VAT) ë³„ë„ ê¸ˆì•¡ì…ë‹ˆë‹¤.</p>
        </div>

        <button type="button" class="btn-submit" onclick="copyResult()">âœ… ê²¬ì ì„œ ì „ì†¡í•˜ê¸°</button>
    </div>
    </form>
</div>

<!-- Admin Setup Modal (ìµœì´ˆ ì ‘ì† ì‹œ) -->
<div id="setupModal" class="modal-overlay" style="background: #2c3e50;">
    <div class="modal-box" style="max-width: 450px; text-align: left;">
        <h2 style="margin-top:0; color:#2c3e50;">âš™ï¸ ë‚˜ë§Œì˜ ê²¬ì ì„œ ë§Œë“¤ê¸°</h2>
        <p style="font-size:14px; color:#666; margin-bottom:20px;">
            êµ¬ë§¤í•˜ì‹  <strong>êµ¬ê¸€ ì‹œíŠ¸ í…œí”Œë¦¿</strong>ì˜ CSV ë§í¬ë¥¼ ì•„ë˜ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.<br>
            ê³ ê°ë‹˜ë§Œì˜ ì „ìš© ê²¬ì ì„œ ë§í¬ê°€ ìƒì„±ë©ë‹ˆë‹¤.
        </p>
        <label style="font-weight:700; font-size:13px; display:block; margin-bottom:5px;">êµ¬ê¸€ ì‹œíŠ¸ CSV ë§í¬</label>
        <input type="text" id="adminSheetUrl" class="form-input" placeholder="https://docs.google.com/..." style="margin-bottom:15px;">
        
        <button class="btn-submit" onclick="createMyLink()">âœ¨ ë‚´ ê²¬ì ì„œ ë§í¬ ìƒì„±í•˜ê¸°</button>
        <p style="font-size:12px; color:#888; margin-top:15px; text-align:center;">
            * ì´ ê¸°ëŠ¥ì€ 'ë§ŒëŠ¥ ìë™ ê²¬ì  í‚¤íŠ¸' êµ¬ë§¤ì ì „ìš©ì…ë‹ˆë‹¤.
        </p>
    </div>
</div>

<!-- Modal -->
<div id="resultModal" class="modal-overlay">
    <div class="modal-box">
        <h3 style="margin:0 0 10px;">ì „ì†¡ ì¤€ë¹„ ì™„ë£Œ! ğŸ‰</h3>
        <p style="font-size:14px; color:#666; line-height: 1.6;">
            ê²¬ì  ë‚´ìš©ì´ <strong>ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.</strong><br>
            í™•ì¸ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ <strong>ë¬¸ì˜í•˜ê¸° ì°½</strong>ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.<br>
            ì±„íŒ…ì°½ì— <strong>ë¶™ì—¬ë„£ê¸°(Ctrl+V)</strong> í•´ì£¼ì„¸ìš”.
        </p>
        <!-- â˜… íŒë§¤ ì‹œ êµ¬ë§¤ìì˜ í¬ëª½/ì˜¤í”ˆì±„íŒ… ì£¼ì†Œë¡œ ë³€ê²½í•˜ë¼ê³  ì•ˆë‚´í•˜ì„¸ìš” -->
        <a href="https://kmong.com" target="_blank" class="modal-btn" style="display:block; text-decoration:none; box-sizing:border-box; text-align:center;" onclick="setTimeout(() => document.getElementById('resultModal').classList.remove('visible'), 300)">í™•ì¸ (ì´ë™í•˜ê¸°)</a>
    </div>
</div>

<script>
    // ğŸ’° ê¸°ë³¸ ì„¤ì • (ì‹œíŠ¸ê°€ ì—†ì„ ë•Œ ë³´ì—¬ì¤„ ê¸°ë³¸ê°’)
    let PRICES = {
        SITE_TITLE: "ğŸ§® ìë™ ê²¬ì  ê³„ì‚°ê¸°",
        SITE_DESC: "ì›í•˜ì‹œëŠ” ì˜µì…˜ì„ ì„ íƒí•˜ë©´ ì˜ˆìƒ ê²¬ì ì„ ì¦‰ì‹œ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
        
        // ì§ˆë¬¸ í…ìŠ¤íŠ¸ (ìƒˆë¡œ ì¶”ê°€ë¨)
        LBL_PROJECT: "Q. í”„ë¡œì íŠ¸ëª… (ë˜ëŠ” ì œëª©)",
        LBL_CATEGORY: "Q. ì˜ë¢° ë¶„ì•¼ / ì—…ì¢…",
        LBL_LEVEL: "Q. ì‘ì—… ìœ í˜• (ë‚œì´ë„)",
        LBL_QTY: "Q. ì‘ì—… ìˆ˜ëŸ‰ (ë‹¨ìœ„: ê°œ, ë¶„, í˜ì´ì§€ ë“±)",
        LBL_OPTS: "Q. ì¶”ê°€ ì˜µì…˜ ì„ íƒ",
        CATEGORY_OPTIONS: "ë””ìì¸|ì˜ìƒ í¸ì§‘|IT ê°œë°œ|ë¬¸ì„œ/ê¸€ì“°ê¸°|ê¸°íƒ€", // ê¸°ë³¸ê°’ (íŒŒì´í”„ | ë¡œ êµ¬ë¶„)

        STANDARD: 50000,   // ê¸°ë³¸í˜• ê°€ê²©
        DELUXE: 100000,    // ê³ ê¸‰í˜• ê°€ê²©
        PREMIUM: 200000,   // í”„ë¦¬ë¯¸ì—„ ê°€ê²©
        
        LEVEL1_NAME: "STANDARD (ê¸°ë³¸í˜•)",
        LEVEL2_NAME: "DELUXE (ê³ ê¸‰í˜•)",
        LEVEL3_NAME: "PREMIUM (í”„ë¦¬ë¯¸ì—„)",
        
        UNIT_PRICE: 5000,  // ìˆ˜ëŸ‰ 1ê°œë‹¹ ì¶”ê°€ê¸ˆ (ì˜ˆ: 1ë¶„ë‹¹, 1í˜ì´ì§€ë‹¹)
        BASIC_QUANTITY: 1, // ê¸°ë³¸ ì œê³µ ìˆ˜ëŸ‰ (ì´ ìˆ˜ëŸ‰ê¹Œì§€ëŠ” ì¶”ê°€ê¸ˆ ì—†ìŒ)

        OPT1_PRICE: 30000, // ì˜µì…˜1 (ê¸‰í–‰) ê°€ê²©
        OPT2_PRICE: 50000, // ì˜µì…˜2 (ì›ë³¸) ê°€ê²©
        OPT3_PRICE: 10000, // ì˜µì…˜3 (ìˆ˜ì •) ê°€ê²©
        
        OPT1_NAME: "âš¡ ê¸‰í–‰ ì‘ì—… (ë¹ ë¥¸ ë§ˆê°)",
        OPT2_NAME: "ğŸ¨ ì›ë³¸ íŒŒì¼ ì œê³µ",
        OPT3_NAME: "ğŸ”„ ìˆ˜ì • íšŸìˆ˜ ì¶”ê°€"
    };

    // â˜ï¸ [SaaS ëª¨ë“œ] URLì—ì„œ ì‹œíŠ¸ ì£¼ì†Œ ê°€ì ¸ì˜¤ê¸° (?config=ì£¼ì†Œ)
    const urlParams = new URLSearchParams(window.location.search);
    let SHEET_URL = urlParams.get('config');

    async function loadPricesFromSheet() {
        // 1. URLì— ì„¤ì •ëœ ì‹œíŠ¸ê°€ ì—†ìœ¼ë©´ -> ì„¤ì • ëª¨ë‹¬ ë„ìš°ê¸°
        if (!SHEET_URL) {
            document.getElementById('setupModal').classList.add('visible');
            return;
        }

        // 2. ì‹œíŠ¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        try {
            // [ì•ˆì „ì¥ì¹˜] URL í˜•ì‹ì´ ë§ëŠ”ì§€ ë¨¼ì € í™•ì¸ (httpë¡œ ì‹œì‘í•˜ëŠ”ì§€)
            if (!SHEET_URL.startsWith("http")) {
                console.error("ğŸš¨ ì˜ëª»ëœ URL í˜•ì‹ì…ë‹ˆë‹¤:", SHEET_URL);
                return;
            }

            const response = await fetch(SHEET_URL);
            const text = await response.text();
            
            // [ì•ˆì „ì¥ì¹˜] CSVê°€ ì•„ë‹ˆë¼ ì¼ë°˜ ì›¹í˜ì´ì§€ ë§í¬ë¥¼ ë„£ì—ˆëŠ”ì§€ í™•ì¸
            if (text.includes("<!DOCTYPE html>") || text.includes("<html")) {
                alert("ğŸš¨ ì˜¤ë¥˜: ì˜¬ë°”ë¥¸ CSV ë§í¬ê°€ ì•„ë‹™ë‹ˆë‹¤. 'ì›¹ì— ê²Œì‹œ' ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");
                return;
            }

            const rows = text.split('\n').map(row => row.split(','));
            
            rows.forEach(([key, value]) => {
                if (!key || !value) return;
                const cleanKey = key.trim();
                const cleanVal = value.trim();
                
                // ìˆ«ìì¸ì§€ í…ìŠ¤íŠ¸ì¸ì§€ êµ¬ë³„í•´ì„œ ì €ì¥
                if (cleanKey.includes("NAME") || cleanKey.includes("TITLE") || cleanKey.includes("DESC") || cleanKey.includes("LBL") || cleanKey.includes("CATEGORY")) {
                    PRICES[cleanKey] = cleanVal;
                } else {
                    // [ì•ˆì „ì¥ì¹˜] ê°’ì´ ë¬¸ìê°€ ì•„ë‹ ê²½ìš°ë¥¼ ëŒ€ë¹„í•´ String()ìœ¼ë¡œ ë³€í™˜ í›„ ì²˜ë¦¬
                    const num = parseInt(String(cleanVal).replace(/[^0-9]/g, ''));
                    if (!isNaN(num)) PRICES[cleanKey] = num;
                }
            });
            
            // 3. í™”ë©´ í…ìŠ¤íŠ¸(ì˜µì…˜ëª… ë“±) ì—…ë°ì´íŠ¸
            updateUI();
            calculateTotal();
        } catch (e) { console.log("ì‹œíŠ¸ ì—°ë™ ì‹¤íŒ¨(ê¸°ë³¸ê°’ ì‚¬ìš©)"); }
    }

    function updateUI() {
        // ì œëª© ë° ì„¤ëª…
        document.getElementById('uiTitle').innerText = PRICES.SITE_TITLE;
        document.getElementById('uiDesc').innerText = PRICES.SITE_DESC;

        // ì§ˆë¬¸ ë¼ë²¨ (ìƒˆë¡œ ì¶”ê°€ë¨)
        document.getElementById('lblProject').innerText = PRICES.LBL_PROJECT;
        document.getElementById('lblCategory').innerText = PRICES.LBL_CATEGORY;
        document.getElementById('lblLevel').innerText = PRICES.LBL_LEVEL;
        document.getElementById('lblQty').innerText = PRICES.LBL_QTY;
        document.getElementById('lblOpts').innerText = PRICES.LBL_OPTS;

        // ì¹´í…Œê³ ë¦¬ ëª©ë¡ ì—…ë°ì´íŠ¸ (íŒŒì´í”„ | ë¡œ êµ¬ë¶„ëœ í…ìŠ¤íŠ¸ë¥¼ ëª©ë¡ìœ¼ë¡œ ë³€í™˜)
        const catSelect = document.getElementById('category');
        if (PRICES.CATEGORY_OPTIONS && catSelect) {
            catSelect.innerHTML = '<option value="" selected disabled hidden>ì„ íƒí•´ì£¼ì„¸ìš”</option>';
            const opts = PRICES.CATEGORY_OPTIONS.split('|');
            opts.forEach(opt => {
                const option = document.createElement('option');
                option.value = opt.trim();
                option.innerText = opt.trim();
                catSelect.appendChild(option);
            });
        }
        
        // ë“±ê¸‰ ì´ë¦„
        document.getElementById('optLevel1').innerText = PRICES.LEVEL1_NAME;
        document.getElementById('optLevel2').innerText = PRICES.LEVEL2_NAME;
        document.getElementById('optLevel3').innerText = PRICES.LEVEL3_NAME;
        
        // ì˜µì…˜ ì´ë¦„
        document.getElementById('labelOpt1').innerText = PRICES.OPT1_NAME;
        document.getElementById('labelOpt2').innerText = PRICES.OPT2_NAME;
        document.getElementById('labelOpt3').innerText = PRICES.OPT3_NAME;
    }

    function createMyLink() {
        const inputUrl = document.getElementById('adminSheetUrl').value;
        if (!inputUrl || !inputUrl.includes("http")) {
            alert("ì˜¬ë°”ë¥¸ êµ¬ê¸€ ì‹œíŠ¸ CSV ë§í¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return;
        }
        // í˜„ì¬ í˜ì´ì§€ URLì— config íŒŒë¼ë¯¸í„° ì¶”ê°€í•´ì„œ ì´ë™
        const newUrl = window.location.protocol + "//" + window.location.host + window.location.pathname + "?config=" + encodeURIComponent(inputUrl);
        
        // í´ë¦½ë³´ë“œ ë³µì‚¬ í›„ ì´ë™
        navigator.clipboard.writeText(newUrl).then(() => {
            alert("âœ¨ ë§í¬ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!\ní´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìœ¼ë‹ˆ ì£¼ì†Œì°½ì— ë¶™ì—¬ë„£ì–´ í™•ì¸í•´ë³´ì„¸ìš”.");
            window.location.href = newUrl;
        });
    }

    function openTab(tabName) {
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(tabName).classList.add('active');
        
        // íƒ­ ë²„íŠ¼ í™œì„±í™” ìŠ¤íƒ€ì¼
        const index = tabName === 'tab1' ? 0 : 1;
        document.querySelectorAll('.tab-btn')[index].classList.add('active');
    }

    function calculateTotal() {
        const level = document.getElementById('serviceLevel').value;
        if (!level) return;

        const qty = parseInt(document.getElementById('quantity').value) || 1;
        const isOpt1 = document.getElementById('opt1').checked;
        const isOpt2 = document.getElementById('opt2').checked;
        const isOpt3 = document.getElementById('opt3').checked;

        // 1. ê¸°ë³¸ê¸ˆ
        let base = PRICES[level];

        // 2. ì¶”ê°€ ìˆ˜ëŸ‰ ë¹„ìš©
        let extraQty = Math.max(0, qty - PRICES.BASIC_QUANTITY);
        let qtyCost = extraQty * PRICES.UNIT_PRICE;

        // 3. ì˜µì…˜ ë¹„ìš©
        let optCost = 0;
        if (isOpt1) optCost += PRICES.OPT1_PRICE;
        if (isOpt2) optCost += PRICES.OPT2_PRICE;
        if (isOpt3) optCost += PRICES.OPT3_PRICE;

        let total = base + qtyCost + optCost;

        // í™”ë©´ í‘œì‹œ
        document.getElementById('basePriceDisplay').innerText = base.toLocaleString() + 'ì›';
        document.getElementById('quantityPriceDisplay').innerText = qtyCost.toLocaleString() + 'ì›';
        document.getElementById('optionPriceDisplay').innerText = optCost.toLocaleString() + 'ì›';
        document.getElementById('totalPrice').innerText = total.toLocaleString() + 'ì›';

        return total;
    }

function copyResult() {
        // 1. í™”ë©´ì˜ ì…ë ¥ê°’ë“¤ ìˆ˜ì§‘
        const title = document.getElementById('projectTitle').value || '(ë¯¸ì…ë ¥)';
        const category = document.getElementById('category').value || '(ë¯¸ì„ íƒ)';
        const level = document.getElementById('serviceLevel').value || '(ë¯¸ì„ íƒ)';
        const qty = document.getElementById('quantity').value;
        const total = document.getElementById('totalPrice').innerText;

        const opts = [];
        if(document.getElementById('opt1').checked) opts.push(PRICES.OPT1_NAME);
        if(document.getElementById('opt2').checked) opts.push(PRICES.OPT2_NAME);
        if(document.getElementById('opt3').checked) opts.push(PRICES.OPT3_NAME);
        const optText = opts.length > 0 ? opts.join(', ') : 'ì—†ìŒ';

        // 2. [êµ¬ê¸€ ì‹œíŠ¸ ì „ì†¡] - ì‘ê°€ë‹˜ì˜ 'ë¹„ë°€ í†µë¡œ' ì£¼ì†Œ
        const scriptURL = 'https://script.google.com/macros/s/AKfycbxqfnFnSb3olhwK_cHzHQMwgb-vqfVimfCZ5xStwQfuQK4wHgdkzzH0JGfxUYMiybIhMw/exec'; 
        
        const params = new URLSearchParams();
        params.append('project_title', title);
        params.append('category', category);
        params.append('service_level', level);
        params.append('quantity', qty);
        params.append('option_summary', optText);
        params.append('total_estimate', total);

        // êµ¬ê¸€ ì‹œíŠ¸ë¡œ ë°ì´í„° ì „ì†¡ (ë„·ë¦¬íŒŒì´ ì—†ì´ ë‹¤ì´ë ‰íŠ¸ ì „ì†¡)
        fetch(scriptURL, { 
            method: 'POST', 
            mode: 'no-cors', 
            body: params 
        })
        .then(() => console.log("âœ… êµ¬ê¸€ ì‹œíŠ¸ ì €ì¥ ì™„ë£Œ!"))
        .catch(e => console.log("âŒ ì‹œíŠ¸ ì „ì†¡ ì‹¤íŒ¨:", e));

        // 3. [í´ë¦½ë³´ë“œ ë³µì‚¬ìš© í…ìŠ¤íŠ¸]
        const text = `ğŸ“‹ [ìë™ ê²¬ì  ì˜ë¢°ì„œ]

1. í”„ë¡œì íŠ¸: ${title}
2. ë¶„ì•¼: ${category}
3. ë“±ê¸‰: ${level}
4. ìˆ˜ëŸ‰: ${qty}
5. ì¶”ê°€ ì˜µì…˜: ${optText}

ğŸ’° ì˜ˆìƒ ê²¬ì : ${total}`;

        // 4. ë³µì‚¬í•˜ê³  ëª¨ë‹¬ ë„ìš°ê¸°
        navigator.clipboard.writeText(text).then(() => {
            document.getElementById('resultModal').classList.add('visible');
        }).catch(err => {
            alert('ë³µì‚¬ ì‹¤íŒ¨. ë‚´ìš©ì„ ì§ì ‘ ìº¡ì²˜í•´ì£¼ì„¸ìš”.');
        });
    }
</script>

</body>
</html>


